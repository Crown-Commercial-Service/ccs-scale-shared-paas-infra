# Define environment
language: bash
  
# Only build pushes to master branch
branches:
  only:
  - "/^(feature|bugfix)\\/SCC-[0-9]+.*$/"
  - develop
  - main
    
# Install dependencies
before_install:
  - sudo rm -Rf terraform_"$TF_VERSION"_linux_amd64.zip
  - sudo rm -Rf terraform
  - wget https://releases.hashicorp.com/terraform/"$TF_VERSION"/terraform_"$TF_VERSION"_linux_amd64.zip
  - unzip terraform_"$TF_VERSION"_linux_amd64.zip
  - sudo mv terraform /usr/local/bin/
  - rm terraform_"$TF_VERSION"_linux_amd64.zip

deploy:

# SBX - modify CF_ENVIRONMENT as required
- provider: script
  skip_cleanup: true
  script: CF_ENVIRONMENT=sbx1 bash ./deploy.sh
  on:
    all_branches: true
    condition: "${TRAVIS_PULL_REQUEST_BRANCH:-$TRAVIS_BRANCH} =~ ^(feature|bugfix)\\/SCC-[0-9]+.*$"

# DEVELOP    
- provider: script
  skip_cleanup: true
  script: CF_ENVIRONMENT=dev bash ./deploy.sh
  on:
    branch: develop
    
# INT (SIT)    
- provider: script
  skip_cleanup: true
  script: CF_ENVIRONMENT=int bash ./deploy.sh
  on:
    branch: main
    
env:
  global:
  # ACCESS_KEY_ID 
  - secure: "KXmFuz3PB7sIjOS/wiQ07K8uEHhELu1eCgEorJ1UJMbmJyXodbS32fQJXukuT7NN1KlEL2/0QuWmuKkUC+mopzYBD/ZI37idtwYxIMNOjdU/R+t3GSAzoxdRVdDTVgyq7k58YWthL2ctfODYctX3hj34caSo2snw9r8R1NiNc85WvLEP7UdsusCA+pj41JdOE64iQJnkTRZ3iMLg4aIKJXCE3mB5duNgk7c3Y9UYGQmzCz8bCF9rOMbvBoPvCBHRkz4q+tKGzqrBtM2kdTNQ32qhABo68dxKOCqtQKWiQGIhOY4OSJ6a7wGiqf48r30L1O+qBX5nLy6TGMQog5l7uOj+CQ4KxP86Z5GXBmypOKlE7gojrXFsXPv1Q4yEvPnnHmYf0umS2Xhnbpc5Hy9PidGr6dG3Qo3c4MdyUlhdge/9riuQVOcRuHND3jqbyu9HGLkldX0/GmFKCCRP12V3dj5P1B1LT2/rdI2bMuUp2XB12LsvXu4UyU0QluVLUhu2Uzyh0ChpPgmPq5yp/Pu3h+CyNiOzCapBVlPC3lIAxMC73X9qFvMZMISLf0Hj5sgwdoPVqWNFBRkho1522w5IcfavzsCym7qGJxYz2qyJAcPaQpa0PquYWt7TyMtQtR6+FwPWJCKveItG0pcaOm9APuV2v3ndSQ+3Jsu2ko0OkMQ="
  # SECRET_ACCESS_KEY
  - secure: "Lqs4aSdu3jYY3Vb2GeeeCvGKimLjcGFVOONVbHyQH/rrNpJ7VugBPKc6JG9bo3P0ftGcjqrbe7Q8mbHpsu61plmn17MvhNK1UZTH9OxJoAYYxTL12lVqhSqcHoDOfybw3lTbYVl+L3vuaDtopSKoymr9yrCLaAIqg5gtF+GXuNbrdBNHDiDLRZHOtFXLnOq607tJdoUStCM6yXw5pHvhGd0z1Llj85o71nS/a+5Mt18qs32O21FA0HTwoHpMJ5xwj6LpyTW5LqUf/AXnDL8ssAzKg6QX70yrBTKbxtmDBjOHGF3mFtOq8K00iyTIvz8u8tLF3sUEqpCfFKd7MgrMVjKa4wDRYKGjh3fIWKQn7onkoEPxRC0ssaKhQElo8B284pF9VdPITzHjoXpdoj9T7vmAyU7/2LYDUrGtrKlERb4FjUMHg04QeVSGXqKZY/mEXMTdTJw7mUsHP4DDsG0v0Eo/rIFwksBOGDOOriuklFSRJTz9Jwd2zwqZpn9+B8tFvcCLv81y/ixSuHzsaGQZC2EUQIbyN35n3FtjY79ij1AZMLd89kVl360D/4OkgCzopUfKV9yBoNUeYxQ+9C5BXu2fBUplJjdZtmhBbUzfvpRc/Gh8MZCZto5epFH0PosrtInrhWTjK1IVyy4CPuKrvf0Zds1nqrTj4vWvQALMysU="
  # S3_STATE_BUCKET_NAME
  - secure: "eWgexEHQem45XX+xtLZ6iC23/dKyUADhLQNVn+5z2J1aceZ0KPgSGrzZEKtcfesWO7AxcipsNElC1fzqONuIkQkvq+Juez/mUB72xfH8s1Wxlaioh41S4IvoofnS4vEVUocO9S6b0x96Tr8HDtLKkIyrIgIr6KL6KPUK18uK0ay0ohKuYSzfpfmZWUG7DIJdU+daMeRJ/upG2VVuZ7sOE/9ejrScQPCWjqtVhxV/V+F0gNAosobc2Dn7kocBeR9Xojymt8uI1fpkE8LYz5xzjE4x71Oy8tGbsJk5q1FaNsTphj6xemnjqORe5fbLNdegnjpxuKopH7DRyxnlp9axQi8Z4N69QoyAaJWnU6ut5SSF+SFu0NFvXgiN79MQF/2GlKHb2FltIvFnjr+uaY9G6mjShTSMZNV6pwabuWE11jbkl5Aw5LYbje/Mf+DOLjvSyGuCdP1TeHA8AX3jTNvkewrRiHxJzocqxBJNnlC3vkphF92+x6Bowvkg/eDA5YNo5D6XLXxzs6hf7gMldx//SjE+nXoxzC63DtHm05wsndjcbV+vhLjKoEk1gNWoKveVCc00Jt18L4FURV43XSTU1p2m3FTAcwj68d7DeP4VTca/KRa90bKRL+hFuxaqPrQ/FQW3BgZf3cpxvAi7Ta/hp5HsdmGzMWOqrXUUtjGfHpw="
  # CF_USERNAME
  - secure: "WWqlcyI6dQJXNKpx2FKi1Yae/SpmbVW4kbgeBT4MOS/lfCVHcXpefU4MCs3q2HOXELLTRquTcDIvqg5VNk0ENnQCFwBtjDyV618ewd6Xh7CAGUPqyy5Js/W1Qms007oKYb2XgfS8p4/+3cbYK/GdkvY3nxzQSkKzLQq4acJdHFSQCfXIxRk5yo+YxUf4yMSROBdUipG+A0xnfnenySKX9TspvPbDUkHqsxDqbqIgEuuNBW+SkLLYk/XUIYMP9ai5TGxiWd4TDQSbLRKkLV0rFy7y5bq9IYVjGOr8IyiOVeELW1nt270U989bZ1hcEgmdgJa48eBuoSB3//nCPNkqrVrNbsOgufqQn5AbsC+IpOFKjKvAF8jAN5Y0b1VY1+iW5u9qH06vISXq6TX4KbNbZbKvrsPfK6EC1sz/1nhbLAkeLw1djqC6tjccKaGs1GQ21FV1c5kFQkTgpMCAudq5GpcDpXPNwiV4CoQ+Xj1oVbFKpLnqsdIQVjuh1Uf22WvOk5V1T6N+Cr8UlyTFwr4niiY40D+Dch5lb+FAmUGEPOGIlEE3TTyF2a8jwyt3VP+CMNm/Y8z46OcKRpVvX46ycwZgDnqDjI63kLcD5lNLgGaphJrX+fNvUfmm4dmZcR/9fC+0Z8z7oP5r1m6KhfgH6UbBsHDR8HFzYA38VmeIhp8="
  # CF_PASSWORD
  - secure: "L1fu+5E1S69o+stftNeF8TLKhtNjnkpZBk4nx3ITTkiwpAJVuD5wTchc5/AwZr8wRVbj3oAIHsC+6lP6ocIXHckudyIiLkQoYljaUfbztYOhnb7Ud6W0kRNj9ZCo4bMYqSz1FdSZQZOlX7NOTXr9BBMuo1SXh6eJC9Sa07cn9AYPq4h8lCPWLbh7wQQD9vpuwcL2jlnkajgdWY/R4kD0Ub/vtsybRXeO3jbzDhizyWyJJMx3tyWmGAR+H2BQO24qFWk4zcr+OjrN0b14b9ruAmpRxkVvVstP9pnqmQNXsKMO5NzEQvDw22XCZBH2TN0pG1obsVcWr/F/xwAKgCvvN+DtmPyKMxnkqnL3PfMqSa6ygPLhWNRzrdqf80qAxiRMSqt3DMgpiQzlYKHQ0YSNFDBupR39fux0lE6WO2xuF0eLShBzwg+XunDGs5cJmdUIg2xx+8LW0Si0edvz6XX7kh/M9mMSgrJDOzVuEhQ1sCkSHPGUbuvHraoV/Ty0WiIOdAJ6P8JAGVCPUyAOH5mMolyVo8uB0z3CGRhSQmHz6nLv1WGdPx/q0mkhBZl7OaAdZUpSVLuVUlnAKmiSeMJXIi8D5d5XucA2n+8JyqDC2q8YgmbpccDwYNYKngTYAbw2EDTDwe7fy1ehq2QehhGW4RWgUz2NrHDvvZtQ/xnOpMY="
  - TF_VERSION=1.0.5
